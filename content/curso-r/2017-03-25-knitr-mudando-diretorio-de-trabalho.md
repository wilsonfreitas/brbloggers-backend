+++
title = "Knitr: mudando o diret√≥rio de trabalho"
date = "2017-03-25 20:26:00"
categories = ["curso-r"]
+++

<div><p class="text-muted text-uppercase mb-small text-right"> Por <a href="http://curso-r.com/author/william">William</a> 25/03/2017 </p><div id="post-content"> <p>O pacote <code>knitr</code> &#xE9; um mecanismo r&#xE1;pido, elegante e flex&#xED;vel para gerar relat&#xF3;rios din&#xE2;micos no R. Ele trabalha lado a lado com o <code>rmarkdown</code> para transformar arquivos <code>.Rmd</code> em diversos formatos, como html, pdf e at&#xE9; mesmo word. Misturando <em>chunks</em> de c&#xF3;digo em R com texto puro, LaTeX e html, a tarefa de criar outputs para an&#xE1;lises estat&#xED;sticas no R ficou muito mais simples.</p>
<p>Quando estamos trabalhando com arquivos Rmarkdown no Rstudio, o diret&#xF3;rio de trabalho &#xE9; a pr&#xF3;pria pasta onde o <code>Rmd</code> est&#xE1; salvo. Assim, se o nosso relat&#xF3;rio tem algum input (banco de dados, arquivos com c&#xF3;digo em R ou imagens, por exemplo), esses arquivos precisam estar nessa pasta. Isso pode ser uma chatea&#xE7;&#xE3;o se voc&#xEA; est&#xE1; dentro de um projeto e organizou os arquivos de forma diferente: banco de dados em uma pasta, <code>.R</code> em outra, imagens em outra, outputs em outra&#x2026;</p>
<p>A primeira ideia que vem &#xE0; cabe&#xE7;a &#xE9; usar a fun&#xE7;&#xE3;o <code>setwd()</code> dentro de algum chunk para mudar o diret&#xF3;rio de trabalho dentro do arquivo <code>Rmd</code>. No entanto, se fizermos isso, o diret&#xF3;rio de trabalho ser&#xE1; mudado para aquele chunk, mas voltar&#xE1; a ser a pasta do arquivo <code>.Rmd</code> ap&#xF3;s a sua execu&#xE7;&#xE3;o. Veja o <code>warning</code> abaixo.</p>
<pre class="r"><code>setwd(&apos;../&apos;) # Warning message: you changed the working directory # to C:/novo_diretorio (probably via setwd()). # It will be restored to C:/diretorio_do_Rdm. # See the Note section in ?knitr::knit.</code></pre>
<p>Lendo a se&#xE7;&#xE3;o &#x201C;Note&#x201D; do <code>?knitr:knit</code>, verificamos que mudar o diret&#xF3;rio de trabalho via <code>setwd()</code> pode levar a <strong>terr&#xED;veis consequ&#xEA;ncias</strong>. Basicamente, figuras e arquivos de cache podem ser salvos no lugar errado, e o seu relat&#xF3;rio n&#xE3;o ser&#xE1; gerado corretamente. Ainda lendo a se&#xE7;&#xE3;o &#x201C;Note&#x201D;, encontramos a maneira correta de mudar o diret&#xF3;rio de trabalho: setar a op&#xE7;&#xE3;o <code>opts_knit$set(root.dir = ...)</code>.</p>
<pre class="r"><code>opts_knit$set(root.dir = &apos;../&apos;)</code></pre>
<p>Vale ainda ressaltar que a mudan&#xE7;a do diret&#xF3;rio s&#xF3; vai ser definida para os chunks seguintes, isto &#xE9;, se voc&#xEA; fizer a mudan&#xE7;a <code>opts_knit$set(root.dir = &apos;../&apos;)</code> e, no mesmo chunk, tentar ler um arquivo no diret&#xF3;rio pai (<code>source(input.R)</code>, por exemplo), o arquivo n&#xE3;o vai ser encontrado.</p> </div></div>
