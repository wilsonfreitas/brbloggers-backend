+++
title = "O Porta dos Fundos está em decadência?"
date = "2017-03-20 20:26:00"
categories = ["curso-r"]
+++

<div id="post-content"> <p>H&#xE1; alguns anos eu acompanho o canal Porta dos fundos no YouTube, assistindo os v&#xED;deos quase sempre no dia de lan&#xE7;amento. Mesmo dividido entre esquetes boas e ruins, me considero um f&#xE3; da trupe de humoristas (e do Totoro tamb&#xE9;m), principalmente pelo humor sarc&#xE1;stico e pela satiriza&#xE7;&#xE3;o de diversos tabus da nossa sociedade.</p>
<p>Nos &#xFA;ltimos meses, no entanto, meu entusiasmo com o canal vem diminuindo. A necessidade de postar tr&#xEA;s v&#xED;deos por semana para se manter relevante no sistema de recomenda&#xE7;&#xF5;es do YouTube, o que mant&#xE9;m o canal rent&#xE1;vel, me faz perdoar um ou outro conte&#xFA;do sem gra&#xE7;a ou rasteiro, mas sinto que o que era exce&#xE7;&#xE3;o come&#xE7;ou a virar regra.</p>
<p>N&#xE3;o sei se eu que fiquei chato ou se outras pessoas compartilham a minha opini&#xE3;o. Ent&#xE3;o resolvi scrapear informa&#xE7;&#xF5;es do canal e montar algumas visualiza&#xE7;&#xF5;es para tirar essa d&#xFA;vida.</p>
<p>Segue um passo a passo de como fiz isso utilizando o R.</p>
<div id="passo-1-instalar-e-configurar-o-pacote-tuber" class="section level1"> <p>O pacote <code>tuber</code> cont&#xE9;m fun&#xE7;&#xF5;es que permitem acessar a API do YouTube utilizando o R. Assim, podemos ter acesso a diversas estat&#xED;sticas como n&#xFA;mero de likes, n&#xFA;mero de views, coment&#xE1;rios de v&#xED;deos, entre outras.</p>
<p>Para instalar o pacote, rode o c&#xF3;digo <code>install.packages(&quot;tuber&quot;)</code> ou <code>devtools::install_github(&quot;soodoku/tuber&quot;, build_vignettes = TRUE)</code> para baixar a vers&#xE3;o de desenvolvimento mais recente.</p>
<p>Para utilizar o <code>tuber</code> &#xE9; preciso um <em>id</em> e um <em>secret</em> do <a href="https://developers.google.com/youtube/v3/getting-started">Console de Desenvolvimento da Google</a>. Ap&#xF3;s criar uma conta, basta habilitar todas as APIs do YouTube e a Freebase API.</p>
<p>Feito isso, rode o c&#xF3;digo abaixo com o <em>id</em> e <em>secret</em> obtidos pela plataforma para configurar o acesso do <code>tuber</code> &#xE0; API.</p>
<pre class="r"><code>library(tuber) yt_oauth(app_id = &quot;seu_app_id&quot;, app_secret = &quot;seu_app_secret&quot;)</code></pre>
<p>Se tudo foi configurado corretamente, ele abrir&#xE1; uma aba no seu navegador confirmando a autentica&#xE7;&#xE3;o, e voc&#xEA; poder&#xE1; voltar ao R para come&#xE7;ar a scrapear.</p>
</div>
<div id="passo-2-buscar-o-id-dos-videos-do-canal" class="section level1"> <p>Para organizar as informa&#xE7;&#xF5;es dos v&#xED;deos em um banco de dados e gerar as visualiza&#xE7;&#xF5;es, vamos utilizar as seguintes bibliotecas.</p>
<pre class="r"><code>library(dplyr) # Manipula&#xE7;&#xE3;o de dados
library(tidyr) # Manipula&#xE7;&#xE3;o de dados
library(tibble) # Cria&#xE7;&#xE3;o de dataframes
library(lubridate) # Manipula&#xE7;&#xE3;o de datas
library(purrr) # Funcionais
library(ggplot2) # Gr&#xE1;ficos</code></pre>
<p>Precisamos do <em>id</em> de cada v&#xED;deo do Porta dos Fundos para baixar as suas estat&#xED;sticas. A fun&#xE7;&#xE3;o <code>tuber::yt_search()</code> pesquisa por v&#xED;deos e suas informa&#xE7;&#xF5;es. Rodando <code>yt_search(term = &quot;Porta dos fundos&quot;)</code>, obtemos informa&#xE7;&#xF5;es de alguns v&#xED;deos do canal, inclusive que o seu <em>channel id</em> &#xE9; &#x201C;UCEWHPFNilsT0IfQfutVzsag&#x201D;. O <em>channel id</em> &#xE9; essencial para obtermos todos os v&#xED;deos do Porta.</p>
<p>Por default, a fun&#xE7;&#xE3;o <code>yt_search()</code> retorna no m&#xE1;ximo 50 resultados. Contudo, se setarmos os par&#xE2;metros <code>type = &quot;video&quot;</code> e <code>channal_id = &quot;id_de_algum_canal&quot;</code>, o n&#xFA;mero m&#xE1;ximo passa a ser 500 resultados.</p>
<p>Para facilitar o trabalho, eu criei a fun&#xE7;&#xE3;o <code>get_videos_porta()</code>. Ela recebe uma data de in&#xED;cio e de t&#xE9;rmino (em um dataframe com apenas uma linha) e devolve todos os v&#xED;deos do canal Porta dos Fundos nesse per&#xED;odo.</p>
<pre class="r"><code>get_videos_porta &lt;- function(dates) { yt_search(term = &quot;&quot;, type = &quot;video&quot;, channel_id = &quot;UCEWHPFNilsT0IfQfutVzsag&quot;, published_after = dates$start, published_before = dates$end) }</code></pre>
<p>Cada linha do dataframe de datas a seguir representa per&#xED;odos de um ano, de 2012 a 2017. Isso implica que, em cada busca, vou receber os v&#xED;deos do Porta dos Fundos para cada um desses anos. O mutate formata as datas no padr&#xE3;o exigido pela fun&#xE7;&#xE3;o <code>yt_search()</code>. Veja <code>help(yt_search)</code> para mais informa&#xE7;&#xF5;es.</p>
<pre class="r"><code>dates &lt;- tibble(start = seq(ymd(&quot;2012-01-01&quot;), ymd(&quot;2017-01-01&quot;), by = &quot;years&quot;), end = seq(ymd(&quot;2012-12-31&quot;), ymd(&quot;2017-12-31&quot;), by = &quot;years&quot;)) %&gt;% mutate(start = paste(start, &quot;T0:00:00Z&quot;, sep = &quot;&quot;), end = paste(end, &quot;T0:00:00Z&quot;, sep = &quot;&quot;))
</code></pre>
<p>Por fim, atribu&#xED;mos ao objeto <code>videos</code> as informa&#xE7;&#xF5;es de todos os videos do canal de 2012 a 2017.</p>
<pre class="r"><code>
videos &lt;- by_row(.d = dates, ..f = get_videos_porta, .to = &quot;videos_info&quot;)
</code></pre>
</div>
<div id="passo-3-pegar-as-estatisticas-de-cada-video" class="section level1"> <p>Para facilitar essa etapa, eu criei a fun&#xE7;&#xE3;o <code>get_videos_stats()</code>, que recebe um dataframe de uma linha contendo uma coluna <code>$video_id</code> e, usando a fun&#xE7;&#xE3;o <code>tuber::get_stats()</code>, faz o scrape das estat&#xED;sticas do v&#xED;deo.</p>
<pre class="r"><code>get_videos_stats &lt;- function(df_row) { get_stats(video_id = df_row$video_id)
}</code></pre>
<p>Cada elemento da coluna <code>$video_info</code> cont&#xE9;m um dataframe com as informa&#xE7;&#xF5;es dos v&#xED;deos de um determinado ano. Com a fun&#xE7;&#xE3;o <code>dplyr::bind_rows()</code>, juntamos esses dataframes em um s&#xF3;. Ent&#xE3;o selecionamos as colunas de interesse: <em>title</em>, <em>publishedAt</em> e <em>video_id</em>. Por fim, utilizamos os <em>id&#x2019;s</em> para baixar as estat&#xED;sticas de cada v&#xED;deo usando a fun&#xE7;&#xE3;o <code>get_videos_stats()</code>. As estat&#xED;sticas s&#xE3;o salvas na coluna <code>$videos_stats</code> do objeto <code>dados</code>.</p>
<pre class="r"><code>dados &lt;- bind_rows(videos$videos_info) %&gt;% select(title, publishedAt, video_id) %&gt;% by_row(..f = get_videos_stats, .to = &quot;videos_stats&quot;)</code></pre>
</div>
<div id="passo-4-as-visualizacoes" class="section level1"> <p>A primeira visualiza&#xE7;&#xE3;o que resolvi fazer foi um gr&#xE1;fico do n&#xFA;mero de visualiza&#xE7;&#xF5;es pela data de publica&#xE7;&#xE3;o. Uma an&#xE1;lise descuidada desse gr&#xE1;fico pode indicar uma clara redu&#xE7;&#xE3;o dos n&#xFA;meros de views ao longo do tempo. No entanto, &#xE9; preciso levar em conta que v&#xED;deos mais antigos tendem a ter mais views por simplesmente estarem dispon&#xED;veis h&#xE1; mais tempo. Apesar disso, dois fatores me fazem acreditar que a magnitude do n&#xFA;mero de views de um v&#xED;deo &#xE9; alcan&#xE7;ada nos primeiros dias ap&#xF3;s o lan&#xE7;amento. O primeiro se deve ao sistema de recomenda&#xE7;&#xF5;es do YouTube. Na p&#xE1;gina inicial, nem sempre os v&#xED;deos recomendados s&#xE3;o dos canais que voc&#xEA; se inscreveu. Na p&#xE1;gina de canais inscritos, se voc&#xEA; tiver muitas inscri&#xE7;&#xF5;es, &#xE9; f&#xE1;cil perder um v&#xED;deo ou outro de um dos canais que acompanha. O segundo se deve &#xE0; enorme quantidade de conte&#xFA;do dispon&#xED;vel hoje em dia, muito&#xB2; maior do que h&#xE1; quatro, cinco anos. Eu, por exemplo, sou inscrito em mais de vinte canais e n&#xE3;o consigo acompanhar nem cinco deles. Para quem n&#xE3;o pode ficar o dia todo vendo v&#xED;deos, realmente h&#xE1; muita competi&#xE7;&#xE3;o por espa&#xE7;o no YouTube.</p>
<p>E apresento ainda um terceiro fator, contrariando a expectativa de existirem apenas dois. Vivemos na era do <em>hype</em>. O que &#xE9; velho, o que &#xE9; not&#xED;cia da semana passada, j&#xE1; n&#xE3;o interessa mais.</p>
<pre class="r"><code>dados %&gt;% mutate(views = map(videos_stats, .f = &apos;viewCount&apos;)) %&gt;% unnest(views) %&gt;% mutate(views = as.numeric(views), publishedAt = as_date(publishedAt)) %&gt;% ggplot(aes(x = publishedAt, y = views)) + geom_line(aes(y = 1000000, colour = &quot;1 Milh&#xE3;o&quot;)) + geom_line(aes(y = 10000000, colour = &apos;10 Milh&#xF5;es&apos;)) + geom_line(aes(y = 20000000, colour = &apos;20 Milh&#xF5;es&apos;)) + geom_line() + labs(x = &quot;Data de publica&#xE7;&#xE3;o&quot;, y = &quot;Visualiza&#xE7;&#xF5;es&quot;) + theme_bw()</code></pre>
<p><img src="http://curso-r.com/blog/2017-03-20-porta-dos-fundos-decadencia_files/figure-html/unnamed-chunk-9-1.png" width="4800"></p>
<p>Tamb&#xE9;m fiz um gr&#xE1;fico da propor&#xE7;&#xE3;o likes/dislikes pela data de publica&#xE7;&#xE3;o do v&#xED;deo. Parece haver uma leve redu&#xE7;&#xE3;o dessa propor&#xE7;&#xE3;o no &#xFA;ltimo ano, mas &#xE9; arriscado tirar uma conclus&#xE3;o. Refazendo essa an&#xE1;lise no fim de 2017, talvez fique mais claro se o p&#xFA;blico do canal concorda comigo sobre a qualidade do conte&#xFA;do nos &#xFA;ltimos tempos.</p>
<pre class="r"><code>dados %&gt;% mutate(likes = map(videos_stats, .f = &apos;likeCount&apos;), dislikes = map(videos_stats, .f = &apos;dislikeCount&apos;)) %&gt;% unnest(likes, dislikes) %&gt;% mutate(likes = as.numeric(likes), dislikes = as.numeric(dislikes), publishedAt = as_date(publishedAt), prop = likes/dislikes) %&gt;% ggplot(aes(x = publishedAt)) + geom_line(aes(y = prop)) + labs(x = &quot;Data de publica&#xE7;&#xE3;o&quot;, y = &quot;Likes/Dislikes&quot;) + theme_bw()</code></pre>
<p><img src="http://curso-r.com/blog/2017-03-20-porta-dos-fundos-decadencia_files/figure-html/unnamed-chunk-11-1.png" width="4800"></p>
<p>O Porta dos Fundos &#xE9; sem d&#xFA;vida um gigante no YouTube, mas os ind&#xED;cios dessa sucinta an&#xE1;lise colaboram com a minha opini&#xE3;o de que o canal j&#xE1; viveu dias (bem) melhores. Apesar de essa decad&#xEA;ncia poder ser s&#xF3; uma fase ruim, nunca &#xE9; cedo para se reinventar, ter novas ideias, definir as regras do jogo, assim como eles fizeram no in&#xED;cio.</p>
<p>E se faltar ideias, v&#xED;deos com o Totoro s&#xE3;o sempre uma boa alternativa.</p>
</div> </div>
