+++
title = "Análise das emoções de Aécio Neves"
date = "2017-04-15 11:07:31"
categories = ["curso-r"]
+++

<div><p class="text-muted text-uppercase mb-small text-right"> Por <a href="http://curso-r.com/author/julio">Julio</a> 15/04/2017 </p><div id="post-content"> <p>A&#xE9;cio Neves &#xE9; um pol&#xED;tico importante no Brasil. Por muito pouco n&#xE3;o foi eleito Presidente da Rep&#xFA;blica em 2014 e &#xE9; certamente um nome bem influente na atualidade. Mas s&#xE9;rio, toda vez que eu vejo esse cara falando, n&#xE3;o dou a m&#xED;nima para quem ele &#xE9;. Eu apenas fico pensando: &#x2018;Por que ele sempre faz tanta cara de dor?&#x2019;</p>
<p>Pensando nisso, decidi pegar algumas fotos famosas dele e aplicar um algoritmo de Intelig&#xEA;ncia Artificial para reconhecimento de emo&#xE7;&#xF5;es. Se minha hip&#xF3;tese estiver correta, provavelmente esse algoritmo retornaria emo&#xE7;&#xF5;es como &#x201C;dor&#x201D;, &#x201C;tristeza&#x201D; ou &#x201C;descontentamento&#x201D;.</p>
<p>A API escolhida para essa tarefa foi a <a href="https://www.microsoft.com/cognitive-services/en-us/emotion-api">Microsoft Emotions API</a>. O motivo por tr&#xE1;s da escolha n&#xE3;o &#xE9; nada especial: foi o primeiro resultado que apareceu no Google para mim!</p>
<p>As imagens utilizadas para testar o algoritmo contra minha hip&#xF3;tese s&#xE3;o essas aqui:</p>
<p><img src="http://curso-r.com/blog/2017-04-09-aecio_files/figure-html/unnamed-chunk-2-1.png" width="33%"><img src="http://curso-r.com/blog/2017-04-09-aecio_files/figure-html/unnamed-chunk-2-2.png" width="33%"><img src="http://curso-r.com/blog/2017-04-09-aecio_files/figure-html/unnamed-chunk-2-3.png" width="33%"><img src="http://curso-r.com/blog/2017-04-09-aecio_files/figure-html/unnamed-chunk-2-4.png" width="33%"><img src="http://curso-r.com/blog/2017-04-09-aecio_files/figure-html/unnamed-chunk-2-5.png" width="33%"><img src="http://curso-r.com/blog/2017-04-09-aecio_files/figure-html/unnamed-chunk-2-6.png" width="33%"></p>
<div id="obtencao-das-emocoes" class="section level2"> <p>Pacotes carregados para essa an&#xE1;lise:</p>
<pre class="r"><code>library(tidyverse)
library(httr)
library(forcats)
library(grid)
library(gridExtra)</code></pre>
<p>Para obter os resultados, foi necess&#xE1;rio entrar na <a href="https://www.microsoft.com/cognitive-services/en-us/emotion-api">p&#xE1;gina de APIs de vis&#xE3;o da Microsoft</a> e obter uma chave de acesso, guardando-a no objeto <code>key</code>. Depois disso, montei a fun&#xE7;&#xE3;o <code>pegar_emocoes()</code>, que recebe a URL de uma imagem da internet e uma chave de acesso, e retorna uma <code>tibble</code> com as propor&#xE7;&#xF5;es das emo&#xE7;&#xF5;es em cada coluna.</p>
<pre class="r"><code>pegar_emocoes &lt;- function(u_img, key) { u_api &lt;- &apos;https://westus.api.cognitive.microsoft.com/emotion/v1.0/recognize&apos; result &lt;- httr::POST( url = u_api, httr::content_type(&apos;application/json&apos;), httr::add_headers(.headers = c(&apos;Ocp-Apim-Subscription-Key&apos; = key)), body = list(url = u_img), encode = &apos;json&apos; ) tibble::as_tibble(httr::content(result, &apos;parsed&apos;)[[1]]$scores)
}</code></pre>
<p>Finalmente, apliquei a fun&#xE7;&#xE3;o num vetor de links usando o funcional <code>purrr::map_df</code>. Como resultado, temos essa base de dados:</p>
<pre class="r"><code>d_emocoes &lt;- map_df(u_imagens, pegar_emocoes, key = key, .id = &apos;id&apos;)</code></pre>
<table>
<thead> </thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>0.0004080</td>
<td>0.0000004</td>
<td>0.0000960</td>
<td>0.0000001</td>
<td>0.9994901</td>
<td>0.0000018</td>
<td>0.0000025</td>
<td>0.0000011</td>
</tr>
<tr class="even">
<td>2</td>
<td>0.1466579</td>
<td>0.1385524</td>
<td>0.1392320</td>
<td>0.0000411</td>
<td>0.2569676</td>
<td>0.3143989</td>
<td>0.0032987</td>
<td>0.0008515</td>
</tr>
<tr class="odd">
<td>3</td>
<td>0.0759952</td>
<td>0.0321533</td>
<td>0.0072514</td>
<td>0.0000727</td>
<td>0.0007214</td>
<td>0.6251250</td>
<td>0.2585501</td>
<td>0.0001311</td>
</tr>
<tr class="even">
<td>4</td>
<td>0.0772784</td>
<td>0.1994352</td>
<td>0.0216270</td>
<td>0.0008681</td>
<td>0.0124632</td>
<td>0.6709319</td>
<td>0.0042846</td>
<td>0.0131115</td>
</tr>
<tr class="odd">
<td>5</td>
<td>0.0476197</td>
<td>0.0467561</td>
<td>0.0026372</td>
<td>0.0000568</td>
<td>0.0008743</td>
<td>0.8483697</td>
<td>0.0532359</td>
<td>0.0004504</td>
</tr>
<tr class="even">
<td>6</td>
<td>0.2786264</td>
<td>0.0922678</td>
<td>0.0087203</td>
<td>0.0119777</td>
<td>0.0000222</td>
<td>0.4820632</td>
<td>0.0069891</td>
<td>0.1193333</td>
</tr>
</tbody>
</table>
</div>
<div id="resultados" class="section level2"> <p>A Figura <a href="http://curso-r.com/blog/2017/04/15/2017-04-09-aecio/#fig:media">1</a> mostra a m&#xE9;dia de cada emo&#xE7;&#xE3;o nas seis fotos. Para minha surpresa, a emo&#xE7;&#xE3;o com maior propor&#xE7;&#xE3;o m&#xE9;dia foi &#x201C;neutro&#x201D;, com peso de quase 50%. As emo&#xE7;&#xF5;es seguintes s&#xE3;o &#x201C;felicidade&#x201D;, &#x201C;raiva&#x201D; e &#x201C;desd&#xE9;m&#x201D;. A emo&#xE7;&#xE3;o &#x201C;tristeza&#x201D;, que achei que seria frequente por conta da cara de dor do A&#xE9;cio, ficou com uma propor&#xE7;&#xE3;o m&#xE9;dia de apenas 5,5%.</p>
<div class="figure"><span id="fig:media"></span>
<img src="http://curso-r.com/blog/2017-04-09-aecio_files/figure-html/media-1.png" alt="M&#xE9;dia de cada emo&#xE7;&#xE3;o nas seis fotos baixadas." width="864">
<p class="caption">
Figure 1: M&#xE9;dia de cada emo&#xE7;&#xE3;o nas seis fotos baixadas.
</p>
</div>
<p>A Figura <a href="http://curso-r.com/blog/2017/04/15/2017-04-09-aecio/#fig:each">2</a> mostra os resultados individuais das imagens. O primeiro resultado faz sentido, j&#xE1; que o A&#xE9;cio est&#xE1; nitidamente rindo. Em todos os casos, &#xE9; poss&#xED;vel interpretar os resultados olhando a imagem. Por exemplo, o caso com &#x201C;tristeza&#x201D; mais alto &#xE9; o que observamos as sombrancelhas mais ca&#xED;das.</p>
<div class="figure"><span id="fig:each"></span>
<img src="http://curso-r.com/blog/2017-04-09-aecio_files/figure-html/each-1.png" alt="Emo&#xE7;&#xF5;es do A&#xE9;cio em cada imagem." width="672">
<p class="caption">
Figure 2: Emo&#xE7;&#xF5;es do A&#xE9;cio em cada imagem.
</p>
</div>
</div>
<div id="conclusao" class="section level2"> <p>Aparentemente minha hip&#xF3;tese estava errada. A&#xE9;cio &#xE9; um cara neutro e feliz, com acessos raiva de vez em quando (por favor, n&#xE3;o interprete isso seriamente, &#xE9; uma brincadeira!). Mas, sinceramente, achei que faltou na API uma emo&#xE7;&#xE3;o &#x201C;cara de dor&#x201D; para captar perfeitamente a express&#xE3;o do A&#xE9;cio. De qualquer forma, foi uma an&#xE1;lise r&#xE1;pida e muito divertida de fazer. Se quiser replic&#xE1;-la para outras imagens, acesse o <a href="https://github.com/curso-r/site">c&#xF3;digo fonte no reposit&#xF3;rio do GitHub que gera esse site</a>.</p>
<p>&#xC9; isso. Happy coding ;)</p>
</div> </div></div>
